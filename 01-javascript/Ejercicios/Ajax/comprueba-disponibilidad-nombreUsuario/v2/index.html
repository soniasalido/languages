<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        .error{
            background : darkred;
            color : white;
        }
    </style>
</head>
<body>

    <div></div>
    <form action="#" method="POST">
        <label for="nombreUsuario">Nombre Usuario:</label>
        <input type="text" name="nombreUsuario" id="nombreUsuario"/>
        <span id="resultadoComprobacionUsuario"></span>

        <label for="passwoord">Contrase√±a:</label>
        <input type="password" name="password" id="passwoord"/>

        <input type="button" id="Enviar" value="Enviar"/>
    </form>

    <hr>

    <form action="#">
        <label for="especialidad">Mostrar profesores de:</label>
        <select name="especialidad" id="especialidad">
            <option value="Guitarra">Guitarra</option>
            <option value="Piano">Piano</option>
        </select>
        <input type="button" name="enviar" id="mostrar" value="mostrar"/>
    </form>

    <hr>

    <!-- Para mostrar resultado del response con stringify-->
    <div>
        <h3 id="resultado"></h3>
    </div>


    <div>
        <table id="tablaResultado">
            <tbody>
            <tr>
                <td></td>
            </tr>
            </tbody>
        </table>
    </div>

    <script>
        //Comprueba si el id de usuario existe en la BD.
        $("#nombreUsuario").on("focusout", function(){
            let login = $("#nombreUsuario").val();
            $.ajax({
                url : 'compruebaDisponibilidad.php',
                data : {idUsuario : login },
                type : 'GET',
                dataType: "json",
            })
            .done(function(response){
                console.log(response)
                // Una forma de mostrar el response con stringify
                // document.querySelector("div").innerHTML = JSON.stringify(response);

                if (response.length == 1){
                    $("#resultadoComprobacionUsuario").text(" ERROR!!! El usuario Existe en la BD");
                    $("#resultadoComprobacionUsuario").show(1000);
                    $("#resultadoComprobacionUsuario").addClass("error");
                }else{
                    $("#resultadoComprobacionUsuario").hide(1000);
                }
            })
            .error = response => {
                console.log("Erorr!!!!!")
            }
        });


        //*********************************************************************************
        //Filtro para la BD. Muestra los profesores que son de un tipo
        $("#mostrar").on("click", function(){
            let especialidad = $("#especialidad :selected").val();
            $.ajax({
                url : 'mostrarProfesor.php',
                data : {tipo : especialidad},
                type : 'GET',
                dataType : 'json',
            })
            .done(function(response) {
                mostrarProfesores(response);
            })
            .error = response => {
                console.log("Erorr!!!!!")
            }
        });



        //Funcion para Mostrar contenido del response en una tabla
        function mostrarProfesores(response){
            $("#tablaResultado > tbody").empty();

            //Recorre el resonse para mostrar resultados
            for(let i = 0; i<response.length ; i++) {
                console.log(response[i]['idProfesor']);
                let tr_str = "<tr>" +
                    "<td>" + (i+1) + "</td>" +
                    '<td>' + response[i]['idProfesor'] + '</td>' +
                    "<td>" + response[i]['nombre'] + "</td>" +
                    "<td>" + response[i]['apellidos'] + "</td>" +
                    "<td>" + response[i]['telefono'] + "</td>" +
                    "<td>" + response[i]['password'] + "</td>" +
                    "<td>" + response[i]['tipo'] + "</td>" +
                    "</tr>";
                $("#tablaResultado tbody").append(tr_str);
            }
        }
    </script>
</body>
</html>